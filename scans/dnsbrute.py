import dns.resolver
import sys

dns_report_success = []
dns_report_error = []


def default_word_list() -> list:
    return open_word_list("../../wordlists/default.txt")


def open_word_list(worlist_path) -> list:
    file = open(worlist_path, "r")
    return file.read().splitlines()


def get_subdomains(subdomains) -> None:
    for subdomain in subdomains:
        try:
            resolver = dns.resolver.Resolver()
            target_complet = subdomain + "." + target
            response = resolver.resolve(target_complet, "A")
            for ip in response:
                dns_report_success.append(f"{target_complet} -> {ip}")
        except Exception as error:
            dns_report_error.append(f"subdomain {target_complet} not exists")
            
            
def report_success():
    print("REPORT SUCESS")
    print("===============================================================")
    for dns in dns_report_success:
        print(dns)
    print("===============================================================")
    
    
def report_error():
    print("REPORT ERROR")
    print("===============================================================")
    for dns in dns_report_error:
        print(dns)
    print("===============================================================")
        

if __name__ == "__main__":
    print("DNS BRUTE")
    if len(sys.argv) > 1:
        target = sys.argv[1]
        subdomains = open_word_list(sys.argv[2])
    else:
        target = input("set the dns target: ")
        subdomains = default_word_list()
    get_subdomains(subdomains)
    report_success()
    report_error()
    
    
    